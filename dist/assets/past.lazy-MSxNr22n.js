var we=Object.defineProperty;var de=t=>{throw TypeError(t)};var Ie=(t,e,s)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var fe=(t,e,s)=>Ie(t,typeof e!="symbol"?e+"":e,s),ee=(t,e,s)=>e.has(t)||de("Cannot "+s);var r=(t,e,s)=>(ee(t,e,"read from private field"),s?s.call(t):e.get(t)),x=(t,e,s)=>e.has(t)?de("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),d=(t,e,s,i)=>(ee(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),m=(t,e,s)=>(ee(t,e,"access private method"),s);import{S as Te,p as pe,r as U,s as te,a as z,n as Qe,i as se,b as me,t as Pe,f as Fe,c as De,d as be,e as je,g as R,u as _e,h as Ue,j as n,L as Le,k as ke,l as Ce}from"./index-uhBez7EL.js";import{s as Me,n as Be}from"./utils-km2FGkQ4.js";var O,o,Y,E,A,K,M,_,Z,V,G,H,q,B,J,c,X,re,ie,ne,ae,oe,he,ce,Ee,Re,Ne=(Re=class extends Te{constructor(e,s){super();x(this,c);x(this,O);x(this,o);x(this,Y);x(this,E);x(this,A);x(this,K);x(this,M);x(this,_);x(this,Z);x(this,V);x(this,G);x(this,H);x(this,q);x(this,B);x(this,J,new Set);this.options=s,d(this,O,e),d(this,_,null),d(this,M,pe()),this.options.experimental_prefetchInRender||r(this,M).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,o).addObserver(this),ye(r(this,o),this.options)?m(this,c,X).call(this):this.updateResult(),m(this,c,ae).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return le(r(this,o),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return le(r(this,o),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,m(this,c,oe).call(this),m(this,c,he).call(this),r(this,o).removeObserver(this)}setOptions(e,s){const i=this.options,l=r(this,o);if(this.options=r(this,O).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof U(this.options.enabled,r(this,o))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");m(this,c,ce).call(this),r(this,o).setOptions(this.options),i._defaulted&&!te(this.options,i)&&r(this,O).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,o),observer:this});const h=this.hasListeners();h&&ge(r(this,o),l,this.options,i)&&m(this,c,X).call(this),this.updateResult(s),h&&(r(this,o)!==l||U(this.options.enabled,r(this,o))!==U(i.enabled,r(this,o))||z(this.options.staleTime,r(this,o))!==z(i.staleTime,r(this,o)))&&m(this,c,re).call(this);const a=m(this,c,ie).call(this);h&&(r(this,o)!==l||U(this.options.enabled,r(this,o))!==U(i.enabled,r(this,o))||a!==r(this,B))&&m(this,c,ne).call(this,a)}getOptimisticResult(e){const s=r(this,O).getQueryCache().build(r(this,O),e),i=this.createResult(s,e);return Ae(this,i)&&(d(this,E,i),d(this,K,this.options),d(this,A,r(this,o).state)),i}getCurrentResult(){return r(this,E)}trackResult(e,s){const i={};return Object.keys(e).forEach(l=>{Object.defineProperty(i,l,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(l),s==null||s(l),e[l])})}),i}trackProp(e){r(this,J).add(e)}getCurrentQuery(){return r(this,o)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,O).defaultQueryOptions(e),i=r(this,O).getQueryCache().build(r(this,O),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(e){return m(this,c,X).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,E)))}createResult(e,s){var k;const i=r(this,o),l=this.options,h=r(this,E),a=r(this,A),S=r(this,K),b=e!==i?e.state:r(this,Y),{state:j}=e;let u={...j},w=!1,y;if(s._optimisticResults){const p=this.hasListeners(),I=!p&&ye(e,s),T=p&&ge(e,i,s,l);(I||T)&&(u={...u,...De(j.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:Q,errorUpdatedAt:C,status:v}=u;if(s.select&&u.data!==void 0)if(h&&u.data===(a==null?void 0:a.data)&&s.select===r(this,Z))y=r(this,V);else try{d(this,Z,s.select),y=s.select(u.data),y=be(h==null?void 0:h.data,y,s),d(this,V,y),d(this,_,null)}catch(p){d(this,_,p)}else y=u.data;if(s.placeholderData!==void 0&&y===void 0&&v==="pending"){let p;if(h!=null&&h.isPlaceholderData&&s.placeholderData===(S==null?void 0:S.placeholderData))p=h.data;else if(p=typeof s.placeholderData=="function"?s.placeholderData((k=r(this,G))==null?void 0:k.state.data,r(this,G)):s.placeholderData,s.select&&p!==void 0)try{p=s.select(p),d(this,_,null)}catch(I){d(this,_,I)}p!==void 0&&(v="success",y=be(h==null?void 0:h.data,p,s),w=!0)}r(this,_)&&(Q=r(this,_),y=r(this,V),C=Date.now(),v="error");const N=u.fetchStatus==="fetching",P=v==="pending",F=v==="error",L=P&&N,W=y!==void 0,g={status:v,fetchStatus:u.fetchStatus,isPending:P,isSuccess:v==="success",isError:F,isInitialLoading:L,isLoading:L,data:y,dataUpdatedAt:u.dataUpdatedAt,error:Q,errorUpdatedAt:C,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>b.dataUpdateCount||u.errorUpdateCount>b.errorUpdateCount,isFetching:N,isRefetching:N&&!P,isLoadingError:F&&!W,isPaused:u.fetchStatus==="paused",isPlaceholderData:w,isRefetchError:F&&W,isStale:ue(e,s),refetch:this.refetch,promise:r(this,M)};if(this.options.experimental_prefetchInRender){const p=D=>{g.status==="error"?D.reject(g.error):g.data!==void 0&&D.resolve(g.data)},I=()=>{const D=d(this,M,g.promise=pe());p(D)},T=r(this,M);switch(T.status){case"pending":e.queryHash===i.queryHash&&p(T);break;case"fulfilled":(g.status==="error"||g.data!==T.value)&&I();break;case"rejected":(g.status!=="error"||g.error!==T.reason)&&I();break}}return g}updateResult(e){const s=r(this,E),i=this.createResult(r(this,o),this.options);if(d(this,A,r(this,o).state),d(this,K,this.options),r(this,A).data!==void 0&&d(this,G,r(this,o)),te(i,s))return;d(this,E,i);const l={},h=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,S=typeof a=="function"?a():a;if(S==="all"||!S&&!r(this,J).size)return!0;const f=new Set(S??r(this,J));return this.options.throwOnError&&f.add("error"),Object.keys(r(this,E)).some(b=>{const j=b;return r(this,E)[j]!==s[j]&&f.has(j)})};(e==null?void 0:e.listeners)!==!1&&h()&&(l.listeners=!0),m(this,c,Ee).call(this,{...l,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&m(this,c,ae).call(this)}},O=new WeakMap,o=new WeakMap,Y=new WeakMap,E=new WeakMap,A=new WeakMap,K=new WeakMap,M=new WeakMap,_=new WeakMap,Z=new WeakMap,V=new WeakMap,G=new WeakMap,H=new WeakMap,q=new WeakMap,B=new WeakMap,J=new WeakMap,c=new WeakSet,X=function(e){m(this,c,ce).call(this);let s=r(this,o).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(Qe)),s},re=function(){m(this,c,oe).call(this);const e=z(this.options.staleTime,r(this,o));if(se||r(this,E).isStale||!me(e))return;const i=Pe(r(this,E).dataUpdatedAt,e)+1;d(this,H,setTimeout(()=>{r(this,E).isStale||this.updateResult()},i))},ie=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,o)):this.options.refetchInterval)??!1},ne=function(e){m(this,c,he).call(this),d(this,B,e),!(se||U(this.options.enabled,r(this,o))===!1||!me(r(this,B))||r(this,B)===0)&&d(this,q,setInterval(()=>{(this.options.refetchIntervalInBackground||Fe.isFocused())&&m(this,c,X).call(this)},r(this,B)))},ae=function(){m(this,c,re).call(this),m(this,c,ne).call(this,m(this,c,ie).call(this))},oe=function(){r(this,H)&&(clearTimeout(r(this,H)),d(this,H,void 0))},he=function(){r(this,q)&&(clearInterval(r(this,q)),d(this,q,void 0))},ce=function(){const e=r(this,O).getQueryCache().build(r(this,O),this.options);if(e===r(this,o))return;const s=r(this,o);d(this,o,e),d(this,Y,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Ee=function(e){je.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,E))}),r(this,O).getQueryCache().notify({query:r(this,o),type:"observerResultsUpdated"})})},Re);function $e(t,e){return U(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ye(t,e){return $e(t,e)||t.state.data!==void 0&&le(t,e,e.refetchOnMount)}function le(t,e,s){if(U(e.enabled,t)!==!1){const i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&ue(t,e)}return!1}function ge(t,e,s,i){return(t!==e||U(i.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&ue(t,s)}function ue(t,e){return U(e.enabled,t)!==!1&&t.isStaleByTime(z(e.staleTime,t))}function Ae(t,e){return!te(t.getCurrentResult(),e)}var Oe=R.createContext(!1),He=()=>R.useContext(Oe);Oe.Provider;function qe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var We=R.createContext(qe()),Ke=()=>R.useContext(We),Ve=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},Ge=t=>{R.useEffect(()=>{t.clearReset()},[t])},Je=({result:t,errorResetBoundary:e,throwOnError:s,query:i})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&Me(s,[t.error,i]),Xe=t=>{t.suspense&&(typeof t.staleTime!="number"&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Ye=(t,e)=>t.isLoading&&t.isFetching&&!e,Ze=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,xe=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function ze(t,e,s){var j,u,w,y,Q;const i=_e(),l=He(),h=Ke(),a=i.defaultQueryOptions(t);(u=(j=i.getDefaultOptions().queries)==null?void 0:j._experimental_beforeQuery)==null||u.call(j,a),a._optimisticResults=l?"isRestoring":"optimistic",Xe(a),Ve(a,h),Ge(h);const S=!i.getQueryCache().get(a.queryHash),[f]=R.useState(()=>new e(i,a)),b=f.getOptimisticResult(a);if(R.useSyncExternalStore(R.useCallback(C=>{const v=l?()=>{}:f.subscribe(je.batchCalls(C));return f.updateResult(),v},[f,l]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),R.useEffect(()=>{f.setOptions(a,{listeners:!1})},[a,f]),Ze(a,b))throw xe(a,f,h);if(Je({result:b,errorResetBoundary:h,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash)}))throw b.error;if((y=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||y.call(w,a,b),a.experimental_prefetchInRender&&!se&&Ye(b,l)){const C=S?xe(a,f,h):(Q=i.getQueryCache().get(a.queryHash))==null?void 0:Q.promise;C==null||C.catch(Be).finally(()=>{f.hasListeners()||f.updateResult()})}return a.notifyOnChangeProps?b:f.trackResult(b)}function Se(t,e){return ze(t,Ne)}async function et(t){return await(await fetch(`/api/past-orders?page=${t}`)).json()}async function tt(t){return await(await fetch(`/api/past-order/${t}`)).json()}const st=({children:t})=>{const e=R.useRef(null);return e.current||(e.current=document.createElement("div")),R.useEffect(()=>{const s=document.getElementById("modal");return s.appendChild(e.current),()=>s.removeChild(e.current)},[]),Ue.createPortal(n.jsx("div",{children:t}),e.current)};class rt extends R.Component{constructor(){super(...arguments);fe(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(s,i){console.error("ErrorBoundary caught an error",s,i)}render(){return this.state.hasError?n.jsxs("div",{className:"error-boundary",children:[n.jsx("h2",{children:"Uh oh!"}),n.jsxs("p",{children:["There was an error with this page! ",n.jsx(Le,{children:"Click here"})," to go back to home."]})]}):this.props.children}}const lt=ke("/past")({component:it}),ve=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function it(){const t=Ce.c(6),[e,s]=R.useState(1);let i;t[0]!==e?(i={queryKey:["past-orders",e],queryFn:()=>et(e),staleTime:3e4},t[0]=e,t[1]=i):i=t[1];const l=Se(i).promise;let h;t[2]===Symbol.for("react.memo_cache_sentinel")?(h=n.jsx("div",{className:"past-orders",children:n.jsx("h2",{children:"Loading Past Orders …"})}),t[2]=h):h=t[2];let a;return t[3]!==l||t[4]!==e?(a=n.jsx(rt,{children:n.jsx(R.Suspense,{fallback:h,children:n.jsx(nt,{loadedPromise:l,page:e,setPage:s})})}),t[3]=l,t[4]=e,t[5]=a):a=t[5],a}function nt(t){const e=Ce.c(39),{loadedPromise:s,page:i,setPage:l}=t,h=R.use(s),[a,S]=R.useState();let f,b;e[0]!==a?(f=["past-order",a],b=()=>tt(a),e[0]=a,e[1]=f,e[2]=b):(f=e[1],b=e[2]);const j=!!a;let u;e[3]!==f||e[4]!==b||e[5]!==j?(u={queryKey:f,queryFn:b,enabled:j,staleTime:864e5},e[3]=f,e[4]=b,e[5]=j,e[6]=u):u=e[6];const{isLoading:w,data:y}=Se(u);let Q;e[7]===Symbol.for("react.memo_cache_sentinel")?(Q=n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("td",{children:"ID"}),n.jsx("td",{children:"Date"}),n.jsx("td",{children:"Time"})]})}),e[7]=Q):Q=e[7];let C;if(e[8]!==h){let T;e[10]===Symbol.for("react.memo_cache_sentinel")?(T=D=>n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("button",{onClick:()=>S(D.order_id),children:D.order_id})}),n.jsx("td",{children:D.date}),n.jsx("td",{children:D.time})]},D.order_id),e[10]=T):T=e[10],C=h.map(T),e[8]=h,e[9]=C}else C=e[9];let v;e[11]!==C?(v=n.jsxs("table",{children:[Q,n.jsx("tbody",{children:C})]}),e[11]=C,e[12]=v):v=e[12];const N=i<=1;let P;e[13]!==i||e[14]!==l?(P=()=>l(i-1),e[13]=i,e[14]=l,e[15]=P):P=e[15];let F;e[16]!==N||e[17]!==P?(F=n.jsx("button",{disabled:N,onClick:P,children:"Previous"}),e[16]=N,e[17]=P,e[18]=F):F=e[18];let L;e[19]!==i?(L=n.jsx("div",{children:i}),e[19]=i,e[20]=L):L=e[20];const W=h.length<10;let $;e[21]!==i||e[22]!==l?($=()=>l(i+1),e[21]=i,e[22]=l,e[23]=$):$=e[23];let g;e[24]!==W||e[25]!==$?(g=n.jsx("button",{disabled:W,onClick:$,children:"Next"}),e[24]=W,e[25]=$,e[26]=g):g=e[26];let k;e[27]!==F||e[28]!==L||e[29]!==g?(k=n.jsxs("div",{className:"pages",children:[F,L,g]}),e[27]=F,e[28]=L,e[29]=g,e[30]=k):k=e[30];let p;e[31]!==a||e[32]!==w||e[33]!==y?(p=a?n.jsxs(st,{children:[n.jsxs("h2",{children:["Order #",a]}),w?n.jsx("p",{children:"Loading …"}):n.jsxs("table",{children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("td",{children:"Image"}),n.jsx("td",{children:"Name"}),n.jsx("td",{children:"Size"}),n.jsx("td",{children:"Quantity"}),n.jsx("td",{children:"Price"}),n.jsx("td",{children:"Total"})]})}),n.jsx("tbody",{children:y.orderItems.map(at)})]}),n.jsx("button",{onClick:()=>S(),children:"Close"})]}):null,e[31]=a,e[32]=w,e[33]=y,e[34]=p):p=e[34];let I;return e[35]!==k||e[36]!==p||e[37]!==v?(I=n.jsxs("div",{className:"past-orders",children:[v,k,p]}),e[35]=k,e[36]=p,e[37]=v,e[38]=I):I=e[38],I}function at(t){return n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("img",{src:t.image,alt:t.name})}),n.jsx("td",{children:t.name}),n.jsx("td",{children:t.size}),n.jsx("td",{children:t.quantity}),n.jsx("td",{children:ve.format(t.price)}),n.jsx("td",{children:ve.format(t.total)})]},`${t.pizzaTypeId}_${t.size}`)}export{lt as Route};
